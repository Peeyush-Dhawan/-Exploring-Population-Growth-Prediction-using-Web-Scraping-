import requests
from bs4 import BeautifulSoup
import pandas as pd

# Wikipedia page URL for fertility rate data
url = 'https://en.wikipedia.org/wiki/List_of_countries_by_total_fertility_rate'

# Fetch the page content
response = requests.get(url)

# Check if the request was successful
if response.status_code == 200:
    # Parse the HTML using BeautifulSoup
    soup = BeautifulSoup(response.content, 'html.parser')

    # Find the table containing fertility rate data
    table = soup.find('table', {'class': 'wikitable'})

    # Extract table rows
    rows = table.find_all('tr')

    # Prepare a list to store the data
    data = []

    # Iterate through the rows and extract country names and fertility rates
    for row in rows[1:]:  # Skip the header row
        cols = row.find_all('td')
        if len(cols) > 1:
            # Extract country name and fertility rate correctly
            country = cols[1].get_text(strip=True)  # Country name is in the second column
            fertility_rate = cols[2].get_text(strip=True)  # Fertility rate is in the third column
            data.append([country, fertility_rate])

    # Create a pandas DataFrame
    df = pd.DataFrame(data, columns=['Country', 'Fertility Rate'])

    # Display the first few rows
    print(df.head())

else:
    print(f"Failed to retrieve the webpage. Status code: {response.status_code}")
